using System;
using System.Collections;
using System.Linq;
using System.Runtime.CompilerServices;
using UnityEngine;
using VRC.SDKBase;

namespace Exploits
{
	// Token: 0x0200002E RID: 46
	[NullableContext(1)]
	[Nullable(0)]
	internal class GeneralPickups
	{
		// Token: 0x060000C1 RID: 193 RVA: 0x0000791E File Offset: 0x00005B1E
		public static VRC_Pickup[] getpickups()
		{
			if (GeneralPickups.AllItems == null)
			{
				GeneralPickups.AllItems = Resources.FindObjectsOfTypeAll<VRC_Pickup>().ToArray<VRC_Pickup>();
			}
			return GeneralPickups.AllItems;
		}

		// Token: 0x060000C2 RID: 194 RVA: 0x0000793B File Offset: 0x00005B3B
		public static void ReloadPickupList()
		{
			GeneralPickups.AllItems = null;
			GeneralPickups.AllItems = Resources.FindObjectsOfTypeAll<VRC_Pickup>().ToArray<VRC_Pickup>();
		}

		// Token: 0x060000C3 RID: 195 RVA: 0x00007954 File Offset: 0x00005B54
		public static void RespawnPickups()
		{
			foreach (VRC_Pickup vrc_Pickup in GeneralPickups.getpickups())
			{
				if (vrc_Pickup != null)
				{
					if (!Networking.LocalPlayer.IsOwner(vrc_Pickup.gameObject))
					{
						Networking.LocalPlayer.TakeOwnership(vrc_Pickup.gameObject);
					}
					vrc_Pickup.transform.position = new Vector3(0f, -100000f, 0f);
				}
			}
		}

		// Token: 0x060000C4 RID: 196 RVA: 0x000079C4 File Offset: 0x00005BC4
		public static void VanishItems()
		{
			foreach (VRC_Pickup vrc_Pickup in GeneralPickups.getpickups())
			{
				if (vrc_Pickup != null)
				{
					if (!Networking.LocalPlayer.IsOwner(vrc_Pickup.gameObject))
					{
						Networking.LocalPlayer.TakeOwnership(vrc_Pickup.gameObject);
					}
					vrc_Pickup.transform.position = new Vector3(0f, 999800f, 0f);
				}
			}
		}

		// Token: 0x060000C5 RID: 197 RVA: 0x00007A33 File Offset: 0x00005C33
		public static IEnumerator DropItems()
		{
			float startTime = Time.time;
			VRC_Pickup[] pickups = GeneralPickups.getpickups();
			int num;
			for (int index = 0; index < pickups.Length; index = num + 1)
			{
				VRC_Pickup vrc_Pickup = pickups[index];
				if (!Networking.LocalPlayer.IsOwner(vrc_Pickup.gameObject))
				{
					Networking.SetOwner(VRCPlayer.field_Internal_Static_VRCPlayer_0.field_Private_VRCPlayerApi_0, vrc_Pickup.gameObject);
				}
				while (Time.time < startTime + 5E-05f)
				{
					yield return null;
				}
				startTime = Time.time;
				num = index;
			}
			while (Time.time < startTime + 0.005f)
			{
				yield return null;
			}
			startTime = Time.time;
			yield break;
		}

		// Token: 0x060000C6 RID: 198 RVA: 0x00007A3B File Offset: 0x00005C3B
		public static IEnumerator FreezeItems(VRCPlayer target = null)
		{
			float startTime = Time.time;
			VRC_Pickup[] pickups = GeneralPickups.getpickups();
			if (target == null)
			{
				while (GeneralPickups.FreezeItemsBool)
				{
					foreach (VRC_Pickup vrc_Pickup in pickups)
					{
						if (Networking.GetOwner(vrc_Pickup.gameObject) != Networking.LocalPlayer)
						{
							Networking.SetOwner(Networking.LocalPlayer, vrc_Pickup.gameObject);
						}
						while (Time.time < startTime + 0.004f)
						{
							yield return null;
						}
						startTime = Time.time;
					}
					VRC_Pickup[] array = null;
				}
			}
			else if (target)
			{
				while (GeneralPickups.TargetedFreezeItemsBool)
				{
					foreach (VRC_Pickup vrc_Pickup2 in pickups)
					{
						if (Networking.GetOwner(vrc_Pickup2.gameObject).displayName == target.field_Private_VRCPlayerApi_0.displayName)
						{
							Networking.SetOwner(Networking.LocalPlayer, vrc_Pickup2.gameObject);
						}
						while (Time.time < startTime + 0.002f)
						{
							yield return null;
						}
						startTime = Time.time;
					}
					VRC_Pickup[] array = null;
				}
			}
			yield break;
		}

		// Token: 0x060000C7 RID: 199 RVA: 0x00007A4A File Offset: 0x00005C4A
		public static IEnumerator RespawnLoop(VRCPlayer target)
		{
			float startTime = Time.time;
			VRC_Pickup[] pickups = GeneralPickups.getpickups();
			while (GeneralPickups.RespawnLoopBool)
			{
				foreach (VRC_Pickup vrc_Pickup in pickups)
				{
					if (Networking.GetOwner(vrc_Pickup.gameObject) != Networking.LocalPlayer)
					{
						Networking.SetOwner(Networking.LocalPlayer, vrc_Pickup.gameObject);
					}
					while (Time.time < startTime + 0.004f)
					{
						yield return null;
					}
					startTime = Time.time;
				}
				VRC_Pickup[] array = null;
			}
			yield break;
		}

		// Token: 0x040000AF RID: 175
		public static VRC_Pickup[] AllItems;

		// Token: 0x040000B0 RID: 176
		public static bool FreezeItemsBool;

		// Token: 0x040000B1 RID: 177
		public static bool TargetedFreezeItemsBool;

		// Token: 0x040000B2 RID: 178
		public static bool RespawnLoopBool;
	}
}
